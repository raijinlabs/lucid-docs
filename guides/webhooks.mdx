---
title: "Webhooks"
description: "Receive real-time notifications for Lucid events"
---

# Webhooks

Configure webhooks to receive HTTP notifications when events occur in your Lucid workspace.

## Events

| Event | Description |
|-------|-------------|
| `receipt.created` | New inference receipt generated |
| `epoch.anchored` | Epoch anchored on Solana |
| `passport.created` | New passport registered |
| `passport.synced` | Passport synced on-chain |
| `agent.started` | Agent execution began |
| `agent.completed` | Agent execution finished |
| `budget.warning` | Session budget at 80% |
| `budget.exceeded` | Session budget exceeded |

## Register a Webhook

```typescript
const webhook = await lucid.webhooks.create({
  url: "https://your-app.com/webhooks/lucid",
  events: ["receipt.created", "epoch.anchored"],
  secret: "whsec_your-signing-secret",
});
```

## Payload Format

```json
{
  "id": "evt_abc123",
  "type": "receipt.created",
  "timestamp": "2026-02-24T10:30:00Z",
  "data": {
    "receiptId": "rec_xyz789",
    "model": "gpt-4o",
    "inputTokens": 150,
    "outputTokens": 320,
    "signatureValid": true
  }
}
```

## Verify Signatures

Every webhook request includes an `X-Lucid-Signature` header. Always verify before processing:

```typescript
import { createHmac, timingSafeEqual } from "crypto";

function verifyWebhook(
  payload: string,
  signature: string,
  secret: string
): boolean {
  const expected = createHmac("sha256", secret)
    .update(payload)
    .digest("hex");
  return timingSafeEqual(
    Buffer.from(signature, "hex"),
    Buffer.from(expected, "hex")
  );
}

// In your Express handler:
app.post("/webhooks/lucid", (req, res) => {
  const sig = req.headers["x-lucid-signature"];
  if (!verifyWebhook(JSON.stringify(req.body), sig, WEBHOOK_SECRET)) {
    return res.status(401).send("Invalid signature");
  }

  const { type, data } = req.body;
  console.log(`Received ${type}:`, data);
  res.status(200).send("OK");
});
```

## Retry Policy

Failed deliveries (non-2xx responses) are retried with exponential backoff:

| Attempt | Delay |
|---------|-------|
| 1st retry | 1 minute |
| 2nd retry | 5 minutes |
| 3rd retry | 30 minutes |
| 4th retry | 2 hours |
| 5th retry | 12 hours |

After 5 failed attempts, the webhook is disabled. Re-enable from the Dashboard or API.

## Manage Webhooks

```typescript
// List webhooks
const webhooks = await lucid.webhooks.list();

// Update events
await lucid.webhooks.update(webhook.id, {
  events: ["receipt.created", "epoch.anchored", "agent.completed"],
});

// Delete
await lucid.webhooks.delete(webhook.id);
```
